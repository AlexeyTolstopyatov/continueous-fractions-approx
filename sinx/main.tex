\documentclass{article}
\usepackage{amsmath}
\usepackage{mathbbol}
\usepackage[russian]{babel}

\title{Представление функций описания угла в виде цепных бесконечных дробей}
\author{Толстопятов А.А.}

\begin{document}
    \maketitle    
    \paragraph*{Представление $\sin(x)$}
    Рассмотрим ряд Тейлора для функции $f(x) = \sin(x)$
    $$\sin(x) = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + \frac{x^9}{9!} - \frac{x^{11}}{11!} + \dots + (-1^{n+1})\frac{x^{2n-1}}{(2n-1)!}$$
    
    Этот ряд сходится для всех $x\in\mathbb{R}$, но чем больше значение $|x|$,
    тем больше элементов необходимо учитывать для достижения точности.
    Например, если аргумент $x > +\pi$, требуется гораздо больше 
    элементов последовательности, чтобы сохранять точность аппроксимации.
    
    Данное выражение структурно представляется в виде 
    многочлена $P_n(x)$, где количество членов описывается 
    элементами множества натуральных чисел $\mathbb{N}$, 
    поскольку выражение представляет бесконечную сумму дробей одного вида.
    $$f(x) = P_n(x) = p_0x^0 + p_1x^1 + p_2x^2 + p_3x^3 + \dots + p_nx^n$$

    Пока что разложение функции описания угла будет указано традиционно $\sin(x)$.
    Как было указано раньше представляет из себя только ряд без каких-либо изменений.
    Рассмотрим альтернативную запись ряда $S_n(x)$
    $$\sin(x) = x\Bigg(1 - \frac{x^2}{3!} + \frac{x^4}{5!} - \frac{x^6}{7!} + \dots + (-1^{n+1})\frac{x^{2n-2}}{(2n-1)!}\Bigg)$$
    $$\sin(x) = x * S_n(x)$$
    $$S_n(x) = \frac{\sin(x)}{x}$$

    \subparagraph{Метод Паде-аппроксимации}
    
    С одной стороны, метод Паде-аппроксимации предоставляют 
    более систематический подход к построению рациональных аппроксимаций,
    что <<играет на руку>> при построении представления в виде бесконечных
    цепных дробей. 
    
    Паде-аппроксимация представляет собой рациональную функцию 
    $R(x)$,
    $$R(x) = \frac{P_n(x)}{Q_m(x)}$$
    Где в данном случае $P_n(x)$ - многочлен степени $n$, а $Q_m(x)$ - многочлен степени $m$. 
    Коэффициенты этих полиномов выбираются так, 
    чтобы ряд данного соотношения $R(x)$ совпадал с рядом функции
    $S_n(x)$ до члена степени $n+m$. Будем считать, что элемент $q_0$ единичный.

    $$P_2(x) = p_0 + p_1x^2$$
    $$Q_2(x) = q_0 + q_1x^2 = 1 + q_1x^2$$

    $$\frac{P_2(x)}{Q_2(x)} = \frac{p_0 + p_1x^2}{1 + q_1x^2}$$

    Желательно, чтобы разложение дроби $R(x)$ в ряд Тейлора совпадало 
    с разложением $S_n(x)$ до члена $x^4$. Разложим дробь в ряд:

    $$(p_0 + p_1*x^2) * (1 - q_1x^2 + (q_1x^2)^2 - \dots) = p_0 + (p_1 - p_0q_1)x^2 + (p_0q_1^2 - p_1q_1)*x^4 + \dots$$

    Сравнивая коэффициенты с рядом для $S_n(x)$, 
    получаем систему уравнений:
    \begin{eqnarray*}
        \begin{cases}
            p_0 = 1 \\
            p_1 - p_0q_1 = -\frac{1}{6} \\
            p_0q_1^2 - p_1q_1 = \frac{1}{120} \\ 
        \end{cases} = 
        \begin{cases}
            p_0 = 1 \\
            p_1 - q_1 = -\frac{1}{6} \\
            q_1^2 - q_1 = \frac{1}{120} \\
        \end{cases} =
        \begin{cases}
            p_0 = 1 \\
            p_1 - q_1 = -\frac{1}{6} \\
            q_1(q_1 - 1) = \frac{1}{120}
        \end{cases} = 
        \begin{cases}
            p_0 = 1 \\
            q_1 = \frac{1}{5} \\
            p_1 = -\frac{1}{6} + \frac{1}{5} = \frac{1}{30} \\
        \end{cases}
    \end{eqnarray*}

    Таким образом, аппроксимация выглядит так:
    $$\frac{1 + \frac{x^2}{30}}{1 + \frac{x^2}{5}}$$

    \subparagraph{Преобразование $R(x)$ в смешанный вид}
    
    Чтобы представить дробно-рациональную функцию в смешанном виде,
    достаточно буквально найти отношение двух многочленов (числитель разделить на знаменатель).
    Скорее всего, как и числа, имеющие остаток от деления, два многочлена тоже
    могут содержать остаток от деления, что как раз поможет представить это в виде цепной дроби.

    $$\frac{1 + \frac{x^2}{30}}{1 + \frac{x^2}{5}} = 1 - \frac{\frac{x^2}{30}}{1 + \frac{x^2}{5}}$$

    Это был только первый шаг. 
    Чтобы получить цепную дробь, нужно продолжить этот процесс, 
    раскладывая $(1 + \frac{x^2}{5})$ в знаменателе.

    После нескольких итераций по преобразованию в итоге получится
    $$S_n(x) = \frac{1}{1 + \frac{x^2}{2*3 - x^2 + \frac{2*3*x^2}{1 + 4*5 - x^2 + \dots}}}$$

    На подобном алгоритме основывается подход по вычислению синуса угла, описанный на языке C++ 20.
    Только для реализации всех тригонометрических функций раскладывается тангенс половинного угла $\tan(\frac{x}{2})$
    и преобразовывается в разного вида цепные дроби, подобные представлениям функций
    косинуса, синуса, тангенса, котангенса.
    Для гиперболических функций так же предусмотрен алгоритм представления
    в виде цепных бесконечных дробей, что будет представлено далее.
\end{document}
